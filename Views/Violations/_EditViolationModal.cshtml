@using PemitManagement.ViewModels.Violations
@model EditViolationViewModel
@{
    var categories = ViewBag.Categories as List<string> ?? new();
    var permitTypes = ViewBag.PermitTypes as List<PermitType> ?? new();
}

<div class="modal fade" id="editViolationModal-@Model.Id" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content violation-modal">

            <form asp-action="Update" asp-controller="Violations" method="post">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="Id" />

                <div class="modal-header">
                    <h5 class="modal-title">Edit Violation</h5>
                    <button class="btn-close btn-close-white"
                            data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">

                    <label class="form-label">Violation Name *</label>
                    <input asp-for="Name" class="form-control mb-3" required />

                    <label>Description</label>
                    <textarea asp-for="Description"
                              class="form-control mb-3"
                              rows="3"></textarea>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label>Category</label>
                            <select asp-for="Category" class="form-select">
                                <option value="">Select</option>
                                @foreach (var c in categories)
                                {
                                    @if (Model.Category == c)
                                    {
                                        <option value="@c" selected>@c</option>
                                    }
                                    else
                                    {
                                        <option value="@c">@c</option>
                                    }
                                }
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label>Severity</label>
                            <select asp-for="Severity" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                    </div>

                    <hr />

                    <label class="fw-semibold">Applicable Permit Types</label>
                    <div class="row">
                        @foreach (var pt in permitTypes)
                        {
                            <div class="col-md-6">
                                <label class="form-check-label">
                                    <input type="checkbox"
                                           class="form-check-input me-1"
                                           name="PermitTypeIds"
                                           value="@pt.Id"
                                           checked="@Model.PermitTypeIds.Contains((int)pt.Id)" />
                                    @pt.Name
                                </label>
                            </div>
                        }
                    </div>

                    <hr />

                    <div class="form-check form-switch mt-3">
                        <input class="form-check-input"
                               type="checkbox"
                               name="Active"
                               value="true"
                               @(Model.Active ? "checked" : "") />

                        <label class="form-check-label">
                            Active
                        </label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-outline-secondary"
                            data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button class="btn btn-primary">
                        Update Violation
                    </button>
                </div>
            </form>

        </div>
    </div>
</div>
